name: Validate Application Form

on:
  issues:
    types: [ opened, edited, reopened, labeled, unlabeled, unassigned ]

jobs:
  update-issue:
    runs-on: ubuntu-latest
    steps:
      - name: Set label as valid
        if: contains(github.event.issue.body, 'xxx') == true
        run: echo "ISSUE_LABEL=valid" >> $GITHUB_ENV
        
      - name: Set label as invalid
        if: contains(github.event.issue.body, 'xxx') == false
        run: echo "ISSUE_LABEL=invalid" >> $GITHUB_ENV
        
      - name: Update issue
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'update-issue'
          title: 'GitHub Contribution Graph Application Form - ${{ github.actor }}'
          body: ${{ github.event.issue.body }}
          update-mode: 'replace'
          labels: 'application-form,${{ env.ISSUE_LABEL }}'
          assignees: '${{ github.actor }}'
          emoji: 'rocket'
  
  create-comment:
    runs-on: ubuntu-latest
    steps:
      - name: Create comment
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'create-comment'
          body: |
            Hello @${{ github.event.issue.user.login }}. Add some comments.
          emoji: '+1,heart'
      - run: echo ${{github.event.issue.type}}
      - name: Welcome comment
        if: github.event.issue.type == 'opened'
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'create-comment'
          body: |
            Welcome, Contributors!
            Our bot will soon validate your form and provide preview via issue comments below.
          emoji: '+1,heart'
  
